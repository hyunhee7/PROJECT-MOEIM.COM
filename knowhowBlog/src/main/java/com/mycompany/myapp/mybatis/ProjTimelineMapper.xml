<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="projTimeline">
	<select id="getList" parameterType="int" resultType="projTimelineDto"> 
		SELECT post_num, post_title, post_content, post_regr_id, post_reg_dtime, post_disp_tf 
		FROM proj_post_board 
		WHERE post_proj_num=#{num} 
		ORDER BY post_num DESC 
	</select>
<!-- 	<insert id="insert" parameterType="projTimelineDto"> 
		INSERT INTO proj_post_board (post_title, post_filePath, post_content, proj_imagePath, proj_date, proj_disp_tf) 
		VALUES(#{post_title},#{post_filePath},#{post_content},#{proj_imagePath}, now(), #{proj_disp_tf}) 
		
		
		INSERT INTO POSTING (post_title, post_filePath, post_content, post_regr_id, post_modr_id, post_proj_num, tag_name, tag_post_num)
				SELECT
					p1.post_title, p1.post_filePath, p1.post_content, p1.post_regr_id, p1.post_modr_id, p1.post_proj_num,
					p2.tag_num, p2.tag_post_num
				FROM PROJ_POST_BOARD p1
				JOIN PROJ_POST_TAG p2 on p2.tag_post_num = p1.post_num		
	</insert>	
	여기부터 join다시하기

	<resultMap id="TagWithPost" type="Tag">
	  <result property="postId" column="post_id"/>
	  <result property="title" column="title"/>
	  <association property="blog" column="blog_id" javaType="Blog">
	    <id property="id" column="blog_id"/>
	    <result property="name" column="blog_name/>
	    <result property="created_on" column="blog_created_on"/>
	  </association>
	</resultMap>
	
	<select id="selectPostWithBlog" parameterType="int" resultMap="PostWithBlog">
	  SELECT p.postId AS post_id, p.title AS title, p.blog_id AS blog_id, b.blogName AS blog_name, b.created_on AS blog_created_on
	  FROM post p JOIN blog B ON p.blog_id=b.blog_id
	  WHERE p.post_id = #{postId}
	</select>
	
	<insert id="insertWithBlog" parameterType="Post" useGeneratedKeys="true" keyProperty="postId">
	        INSERT INTO post (title, blog_id) VALUES (#{title}, SELECT blog_id FROM blog WHERE name=#{blog.name});
	</insert> -->

</mapper>


